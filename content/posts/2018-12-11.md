---
title: "F1 2018のTelemetryをGoでパースしてInfluxDBに流してGrafanaで描画してみる"
date: 2018-12-11
tags:
  - Go
---

今いるベンチャーでは車に搭載するIoTデバイスから加速度、GPS、ジャイロデータをリアルタイムで集めて色々と分析計算しソリューションを提供しています。そのデータの格納先に時系列データベースを使わないかと議論されているので、時系列データベースを自分で試してみたいなと思ってました。

会社の人の影響でF1 2018というゲームに最近ハマっているのですが、このゲームにはゲーム内のデータをUDPプロトコルで送信できるテレメトリー機能が搭載されています。
ゲーム内のF1カーの速度、スロットル/ブレーキ値、ステアリング値、燃料残量、GPSデータ、ラップタイムなどあらゆる情報がリアルタイムで取れます。

これはj時系列データベースを試してみるいいきっかけだなと思い、これらのデータを取得して時系列データベースであるInfluxDBに流し、Grafanaで描画するというのを作ってみました。F1 2018からUDPでMacへ → GoでパースしてInfluxDBへ → Grafanaで表示 という流れ。

コードはこちら [nito95/F1-Telemetry](https://github.com/nito95/F1-Telemetry)

何のデータが取れるのかはこちらを参考にしました [F1 2017 D-Box and UDP Output Specification](https://forums.codemasters.com/topic/20215-f1-2017-d-box-and-udp-output-specification/)

できたもの↓

{{< figure src="/images/2018-12-11-2.gif" width="320" >}}


右のMacにリアルタイムで描画されているのはGrafanaの画面です。ここで表示しているのは速度とスロットル/ブレーキ値です。こんな感じ↓

{{< figure src="/images/2018-12-11-1.png" width="640" >}}

これだけの情報では示唆は少ないですが、ブレーキをフルであまり踏めてないとかブレーキ後のスロットルの踏みがたまに甘いとか多少考察できます。運転しながらリアルタイムで見るのはキツイですが後から振り返るには使えます。

F1エンジニアの人たちはこういった情報を見てレーサーに指示したりマシンのパーツ交換をしたりするんですね。F1エンジニアに興味が出ております。F1を見に行ったことはないですが、観客もテレメトリー情報をリアルタイムで見れたりするんですかね? 見れたらすごい観戦が楽しそうな気がします :)

あとInfluxDB + Grafanaは使いやすく、特に詰まることなくできました。Grafana見た目かっこいいです。これからも使ってみたいと思います。
